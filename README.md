# gulp-template

Базовый шаблон для сборки и тестирования Web-вёрстки на стеке Node.js + Gulp + Pug + Sass по технологии **mobile&#8209;first**.

В шаблон включены: автоматизация, шаблонизация, препроцессинг HTML, CSS, постпроцессинг, сжатие изображений для вёрски сайтов с учётом масштабируемости проектов.

## Сборка проекта

Чтобы выполнить сборку проекта понадобится node.js и конфигурационные файлы из корневого каталога проекта и папки gulp/tasks

Если node.js установлен, зависимости, необходимые для работы с исходными фалйами, устанавливаются с помощью вызова `npm i` в корневом каталоге, в консоли.

## Структура каталогов

Оснавная структура состоит из четырёх папок:

1. `src` - исходный код на PUG, SASS и др.;
2. `dev-build` - рабочий код сборки HTML, CSS, JS;
3. `build` - финальная сборка в HTML, CSS и JS с минификацияей и кэш-бустом кастомных стилей и скриптов;
4. `lab` - рабочий каталог для подготовки и оптимизации материалов сайта.

Таким обраозом, финальная сборка попадёт в папку `build`.

### Структура каталога `src`

- построена по технологии БЭМ,
- каталог `src` содержит каталоги с контентом отдельных html страниц,
- каталог `src` содержит общие стили в папке `common`,
- индексный файл главной страницы `index.pug` находится в корне `src` и включает в себя содержимое `./src/main/main.pug` через `include`,
- прочие страницы собираются из файлов `index.pug`, расположенных в отдельных папках,
- содержимое страниц попадает в проект с неизменным относительным путём от корня `./src/`,
- в проект попадает исходный код только из сборочных файлов:
  - `style.sass`,
  - `index.pug`;
- кастомные скрипты попадают в проект из файлов `custom-script.js` и сборочных файлов `build-script.pug`, которые конвертируются в `custom-script.js`,
- в папке `thirdparty` содержатся файлы сторонних разработчиков, которые попадают в проект в неизменном виде.

## Задачи

Основные задачи:

- `gulp construct`,
- `gulp build`,
- `gulp cleanBuilds`.

Они нужны для отслеживания изменений в `dev-build`, для финальной сборки проекта в `build` и очистки каталогов в случае аварийного завершения работы задачи соответственно.

Проект построен по принципу БЭМ + Sass. Файловая структура построена по принципу БЭМ, но без дополнительных катологов для элементов и модификаторов блоков с целью упрощения дерева файловой системы. Cледуя принципам БЭМ, отсутствует деление на технологии реализации блоков. Файлы sass, js, изображения и т.д. находятся внутри папок блоков, а адаптивные медиа-запросы не вынесены в отдельные бандлы на уровне переопределения, а находятся в sass файлах блоков с целью обеспечения удобства доступа для разработчиков. Переопределение изначально осуществляется на уровне общего (common) уровня и уровня разных страниц из папки `pages`.

### Подзадачи

В проекте используется масса подзадач, среди которых можно отметить:

- Сжатие изображений;
  - Все изображения в `src` автоматически обрабатываются `gulp construction` и `gulp build` и попадают в проект в сжатом виде в подкаталог, соответствующий положений в файловой системе относительно корня `./src/`. 
- Конвертация растровых изображений в webp `gulp convertToWebp`, также встроенная по умолчанию в `build` и `construct`;
- Создание svg-спрайтов `gulp makeSvgSymbolSprite`;
  - Опционально, поместив в папку `./lab/img-vector/input` svg-файлы, с помощью задачи `gulp makeSvgSymbolSprite` можно получить svg-спрайт на основе тегов symbol.
  - Готовый спрайт появится в папке `./lab/img-vector/output`.
- Помимо того в проекте используется browsersync сервер, для динамического отображения изменений в сборках на разных устройствах, раличные улучшения финального кодстайла, автопрефиксеры, и что важно отметить **сортировка медиазапросов стилей по технологии mobile-first**.

Всё это можно настроить и изменить в соответствующих конфигурационных файлах задач, снабжённых достаточно подробными комментариями.